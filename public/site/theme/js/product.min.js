function productUpdateCart(t){var a=$("#modal-cart");void 0!=t.cart_mini&&$("#product-cart-mini").html(t.cart_mini),void 0!=t.cart?(a.find(".modal-dialog").css("width","90%"),a.find(".modal-body").html(t.cart),a.modal("show")):void 0!=t.checkout?(a.find(".modal-dialog").css("width","40%"),a.find(".modal-title").html("Thông tin đặt hàng"),a.find(".modal-body").html(t.checkout),a.modal("show")):(a.find(".modal-dialog").css("width","40%"),a.modal("hide")),nfc.server_response(t)}function productChangeOptionPrice(){$("#product_form_action #price-total-wraper").append('<span class="loader_block"></span>'),$("#product_form_action").ajaxSubmit({data:{_submit:!0,update_price:!0},dataType:"json",success:function(t){$("#product_form_action #price-total-wraper").find("span.loader_block").remove(),t.total&&$("#product_form_action #price-total").html(t.total)}})}function productFilter(t){var a=$(".ajax-content-product-list"),o=$(".ajax-content-product-total");$("body").append('<div class="loader_mini">Loading...</div>');var n=0;$("#form_filter_advance .block-filter input[type=hidden]").each(function(){n++}),n>1?$(".btn-clear-all").show():$(".btn-clear-all").hide();var c="",e=!1;void 0!=t&&(void 0!=t.url&&(c=t.url),void 0!=t.load_more&&(e=t.load_more)),""==c&&(c=$("#form_filter_advance").attr("action")+"?"+$("#form_filter_advance").serialize()+"&"+$("#form_filter_base").serialize()),$("#form_filter_advance").ajaxSubmit({url:c,dataType:"json",success:function(t){return history.pushState("data","",c),$("body > .loader_mini").remove(),t.status?(e?($(".page-pagination").remove(),a.find(".product-list").append(t.content)):a.html(t.content),o.html(t.total),$(".page-pagination .pagination > li:last").hasClass("active")?($("#act-pagination-load-more").parent().hide(),!1):!0):void 0}})}var product_nfc={boot:function(){this.display.boot()},display:{boot:function(){this.common()},common:function(){$(document).ready(function(){function t(t){var a=$(".quantity-up-down-select .quantity-select"),o=a.find("option").length,n=a.prop("selectedIndex")+1;0==t?n--:1==t&&n++,o>=n&&n>=1&&a.val(n),n==o&&($(".quantity-up-down-select .up").addClass("disable"),$(".quantity-up-down-select .down").removeClass("disable")),1==n&&($(".quantity-up-down-select .down").addClass("disable"),$(".quantity-up-down-select .up").removeClass("disable")),n>1&&o>n&&($(".quantity-up-down-select .down").removeClass("disable"),$(".quantity-up-down-select .up").removeClass("disable"))}$("body").on("click","a.product-empty-cart",function(){return confirm("Bản có muốn xóa toàn bộ sản phẩm trong giỏ hàng?")?($.ajax({type:"POST",dataType:"JSON",async:!1,url:$(this).attr("data_url"),success:function(t){productUpdateCart(t)}}),!1):!1}),$("body").on("click","a.product-delete-cart",function(){if(confirm("Bản có muốn xóa sản phẩm này khỏi giỏ hàng?")){var t=$(this).attr("data_product_key");$.ajax({type:"POST",async:!1,url:$(this).attr("data_url"),data:{rowid:t},dataType:"JSON",success:function(t){productUpdateCart(t)}})}}),$("body").on("click","a.product-update-cart",function(){var t=$(this).attr("data_product_key"),a=$("#product-qty-key-"+t).val();return isNaN(a)?(alert(a+"Số lượng sản phẩm không hợp lệ"),!1):void $.ajax({type:"POST",dataType:"JSON",async:!1,url:$(this).attr("data_url"),data:{rowid:t,qty:a},success:function(t){productUpdateCart(t)}})}),$("body").on("click","a.product-apply-coupon-cart",function(){var t=$("#product-coupon-cart").val();return isNaN(t)?(AC_messageShow("Mã không hợp lệ","notice"),!1):void $.ajax({type:"POST",dataType:"JSON",async:!1,url:$(this).attr("data_url"),data:{code:t},success:function(t){t.complete?(AC_messageClear(),$("#cart-info.page-content").html(t.data)):AC_messageShow(t.message,"notice")}})}),$("body").on("click",".quantity-up-down-select .up",function(){$(this).hasClass("disable")||(t(1),$(".quantity-up-down-select .down").removeClass("disable"))}),$("body").on("click",".quantity-up-down-select .down",function(){$(this).hasClass("disable")||($(".quantity-up-down-select .up").removeClass("disable"),t(0))}),$("body").on("change",".quantity-up-down-select .quantity-select",function(){t(2)}),$("#product_form_action").nstUI("formActionAdv",{event_complete:function(t){productUpdateCart(t)}}),$("#product_form_action .product-options select").on("change",function(){productChangeOptionPrice()}),$("#product_form_action .product-options :input[type=checkbox]").on("click",function(){productChangeOptionPrice()}),$("#product-category .pagging-ajax a").bind("click",function(){var t=$(this).attr("href");return void 0!=t&&(t=t.replace("/",""),""==t&&(t=0),productFilter(t)),!1}),$("#product-category .pagging-ajax a").bind("click",function(){var t=$(this).attr("href");return void 0!=t&&(t=t.replace("/",""),""==t&&(t=0),productFilter(t)),!1}),$("a.add-to-compare ").bind("click",function(){var t=$(this).attr("data-compare");$.ajax({async:!1,type:"POST",url:$(this).attr("data-url"),success:function(a){a.count_compare>1?$.colorbox({width:"90%",height:"90%",href:t}):alert(a.msg)}})}),$('#compare-info select[class="product-name"]').on("change",function(){var t=this.value,a=$(this).attr("data-id"),o=$(this).attr("data-col");t&&$.ajax({async:!1,type:"POST",url:$("#compare-info").attr("data-url"),data:{id_new:t,id_old:a,id_col:o},success:function(t){$("#_tmp").html(t),$("#product-compare #compare-info").html($("#_tmp").find("#product-compare #compare-info").html()),$("#_tmp").html("")}})})})}},filter:function(t){productFilter(t)}};product_nfc.boot();